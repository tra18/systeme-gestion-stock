<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer des Employés de Test</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDE-TBWNZ_Y4WdPHaezRXIf1vizPEralVY",
            authDomain: "stock-bcbd3.firebaseapp.com",
            projectId: "stock-bcbd3",
            storageBucket: "stock-bcbd3.appspot.com",
            messagingSenderId: "901950451449",
            appId: "1:901950451449:web:stock-bcbd3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        async function createTestEmployes() {
            try {
                console.log('Connexion en tant que DG...');
                
                // Se connecter avec un compte DG
                const userCredential = await signInWithEmailAndPassword(auth, 'dg@test.com', 'password123');
                console.log('Utilisateur connecté:', userCredential.user.email);
                
                // Créer des employés de test
                const employesTest = [
                    {
                        nom: 'Diallo',
                        prenom: 'Amadou',
                        email: 'amadou.diallo@test.com',
                        telephone: '+224 123 456 789',
                        service: 'Informatique',
                        poste: 'Développeur',
                        dateEmbauche: new Date('2023-01-15'),
                        statut: 'actif',
                        createdAt: new Date(),
                        createdBy: userCredential.user.uid,
                        createdByName: 'Directeur Général'
                    },
                    {
                        nom: 'Traoré',
                        prenom: 'Fatoumata',
                        email: 'fatoumata.traore@test.com',
                        telephone: '+224 987 654 321',
                        service: 'Ressources Humaines',
                        poste: 'Responsable RH',
                        dateEmbauche: new Date('2022-06-01'),
                        statut: 'actif',
                        createdAt: new Date(),
                        createdBy: userCredential.user.uid,
                        createdByName: 'Directeur Général'
                    },
                    {
                        nom: 'Bah',
                        prenom: 'Ibrahima',
                        email: 'ibrahima.bah@test.com',
                        telephone: '+224 555 123 456',
                        service: 'Comptabilité',
                        poste: 'Comptable',
                        dateEmbauche: new Date('2023-03-10'),
                        statut: 'actif',
                        createdAt: new Date(),
                        createdBy: userCredential.user.uid,
                        createdByName: 'Directeur Général'
                    },
                    {
                        nom: 'Camara',
                        prenom: 'Mariama',
                        email: 'mariama.camara@test.com',
                        telephone: '+224 777 888 999',
                        service: 'Achat',
                        poste: 'Acheteur',
                        dateEmbauche: new Date('2022-09-15'),
                        statut: 'actif',
                        createdAt: new Date(),
                        createdBy: userCredential.user.uid,
                        createdByName: 'Directeur Général'
                    },
                    {
                        nom: 'Sow',
                        prenom: 'Ousmane',
                        email: 'ousmane.sow@test.com',
                        telephone: '+224 333 444 555',
                        service: 'Maintenance',
                        poste: 'Technicien',
                        dateEmbauche: new Date('2023-05-20'),
                        statut: 'actif',
                        createdAt: new Date(),
                        createdBy: userCredential.user.uid,
                        createdByName: 'Directeur Général'
                    }
                ];

                console.log('Création des employés de test...');
                
                for (const employe of employesTest) {
                    try {
                        const docRef = await addDoc(collection(db, 'employes'), employe);
                        console.log('Employé créé avec ID:', docRef.id, employe.nom, employe.prenom);
                    } catch (error) {
                        console.error('Erreur lors de la création de l\'employé', employe.nom, ':', error);
                    }
                }
                
                console.log('✅ Employés de test créés avec succès !');
                document.getElementById('result').innerHTML += '<p style="color: green;">✅ Employés de test créés avec succès !</p>';
                
            } catch (error) {
                console.error('Erreur lors de la création des employés:', error);
                document.getElementById('result').innerHTML += '<p style="color: red;">❌ Erreur: ' + error.message + '</p>';
            }
        }

        // Exposer la fonction globalement
        window.createTestEmployes = createTestEmployes;
    </script>
</head>
<body>
    <h1>Créer des Employés de Test</h1>
    <p>Ce script va créer 5 employés de test pour résoudre le problème de la liste vide.</p>
    <button onclick="createTestEmployes()" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">
        Créer les Employés de Test
    </button>
    <div id="result" style="margin-top: 20px;"></div>
    
    <script>
        // Afficher les résultats
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            document.getElementById('result').innerHTML += '<p style="color: green;">LOG: ' + args.join(' ') + '</p>';
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            document.getElementById('result').innerHTML += '<p style="color: orange;">WARN: ' + args.join(' ') + '</p>';
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            document.getElementById('result').innerHTML += '<p style="color: red;">ERROR: ' + args.join(' ') + '</p>';
        };
    </script>
</body>
</html>
